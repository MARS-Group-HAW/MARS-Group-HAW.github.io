"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7323],{17064:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"tutorial/development/agent","title":"Agent","description":"Definition of Agents","source":"@site/docs/tutorial/development/agent.md","sourceDirName":"tutorial/development","slug":"/tutorial/development/agent","permalink":"/docs/tutorial/development/agent","draft":false,"unlisted":false,"editUrl":"https://github.com/MARS-Group-HAW/MARS-Group-HAW.github.io/edit/main/docs/tutorial/development/agent.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"ModelDescription","permalink":"/docs/tutorial/development/model"},"next":{"title":"Entity","permalink":"/docs/tutorial/development/entity"}}');var s=t(74848),r=t(28453);const a={sidebar_position:10},o="Agent",d={},c=[{value:"Definition of Agents",id:"definition-of-agents",level:2},{value:"Agents in MARS",id:"agents-in-mars",level:2},{value:"Implementation of Agents",id:"implementation-of-agents",level:2},{value:"Passing input to the Agent",id:"passing-input-to-the-agent",level:2},{value:"Direct value assignment",id:"direct-value-assignment",level:3},{value:"Indirect value assignment",id:"indirect-value-assignment",level:3},{value:"Alternative names",id:"alternative-names",level:3},{value:"Required properties",id:"required-properties",level:3}];function l(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"agent",children:"Agent"})}),"\n",(0,s.jsx)(n.h2,{id:"definition-of-agents",children:"Definition of Agents"}),"\n",(0,s.jsx)(n.p,{children:"In multi-agent systems, an agent is an autonomous entity capable of perceiving its environment through sensors and acting upon that environment through actuators. Agents can range from simple rule-based systems to complex intelligent programs that learn from experience and adapt their behavior over time. They are often designed to pursue certain goals, make decisions, and interact with other agents or their environment in a meaningful way."}),"\n",(0,s.jsx)(n.p,{children:"During a single tick, the agent undergoes a full cycle of perception, deliberation, and action. This process begins with the exploration of its environment, which gathers sensory input or data about the current state of the world. This sensory information is then interpreted and compared with the agent\u2019s internal knowledge, including past experiences, learned models, and its current intentions or goals."}),"\n",(0,s.jsx)(n.p,{children:"Based on this evaluation, the agent then enters a decision-making phase. Here, it analyzes possible actions within its ActionSpace, which defines the set of actions available to it at any given moment. The agent may apply heuristic rules, learned policies, or optimization methods to select the most suitable action(s) for achieving its objectives."}),"\n",(0,s.jsx)(n.p,{children:"Finally, the chosen action(s) are executed, and the environment is influenced accordingly. This loop repeats with each tick, allowing the agent to continuously adapt and react to changes in its surroundings."}),"\n",(0,s.jsx)(n.h2,{id:"agents-in-mars",children:"Agents in MARS"}),"\n",(0,s.jsxs)(n.p,{children:["Along with ",(0,s.jsx)(n.a,{href:"/docs/tutorial/development/layers",children:"layers"}),", agents are the main part of every model. Once the layers have been created, agent types can be specified. For this step, the modeler needs to know what each agent type is going to be, what attributes define it, and what its actions will look like. Once this has been established, the agent type creation can be started."]}),"\n",(0,s.jsx)(n.p,{children:"Agents are the central part of the MARS simulation, which can be viewed as an information system with three phases. First, there is some kind of input data that is integrated in the model, either in layer or agent. The model execution is then performed and generates output data in different formats for analyzation."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"MARS simulation as information system",src:t(24808).A+"",width:"639",height:"305"})}),"\n",(0,s.jsxs)(n.p,{children:["A more detailed view on the system emphasises that the input files are described in the ",(0,s.jsx)(n.a,{href:"/docs/tutorial/configuration/sim_config_options",children:"simulation config"}),". The input data is used to initialize certain properties of the agent, which may afterwards finalize the initialization process with model code. The model execution ticks the agent in every time step. The output is created automatically by the system. Output formats as well as filter criteria need to be defined in the simulation config. To analyze the results, as for now, external tools are required."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"MARS simulation as information system",src:t(76195).A+"",width:"1191",height:"373"})}),"\n",(0,s.jsx)(n.h2,{id:"implementation-of-agents",children:"Implementation of Agents"}),"\n",(0,s.jsxs)(n.p,{children:["Agent types are defined by implementing the ",(0,s.jsx)(n.code,{children:"IAgent<TLayer>"})," interface. The ",(0,s.jsx)(n.code,{children:"IAgent<TLayer>"})," interface expects the implementation of the ",(0,s.jsx)(n.code,{children:"Init(TLayer)"})," and the ",(0,s.jsx)(n.code,{children:"Tick()"})," method as well as a unique identifier in form of a ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Universally_unique_identifier",children:"UUID"})," (",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/api/System.Guid?view=netstandard-2.0",children:"Guid"}),") which has to be assigned by the ",(0,s.jsx)(n.code,{children:"ID"})," property."]}),"\n",(0,s.jsx)(n.p,{children:"The agent and entity contract is structured as follows:"}),"\n",(0,s.jsx)(n.mermaid,{value:"classDiagram\n    class IModelObject {\n        <<interface>>\n    }\n\n    class IEntity {\n        <<interface>>\n    }\n\n    class ITickClient {\n        <<interface>>\n        +Tick()\n    }\n\n    class IAgent {\n        <<interface>>\n    }\n\n    class Guid {\n        <<interface>>\n    }\n\n    IModelObject <|-- IEntity\n    IModelObject <|-- ITickClient\n    IEntity <|-- IAgent\n    ITickClient <|-- IAgent\n\n    IEntity --\x3e Guid : ID"}),"\n",(0,s.jsxs)(n.p,{children:["In the model code a ",(0,s.jsx)(n.code,{children:"using"})," import for the namespace ",(0,s.jsx)(n.code,{children:"Mars.Interfaces.Agents"})," must be added:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"using Mars.Interfaces.Agents;\n"})}),"\n",(0,s.jsx)(n.p,{children:"An agent definition may look like this."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"using Mars.Interfaces.Agents;\n\npublic class MyAgentType : IAgent<MyLayer> \n{\n    public void Init(MyLayer layer) \n    {\n\t    // finalize the init process\n    }\n    \n    public void Tick() \n    {\n\t    // define your logic here\n    }\n    \n    public Guid ID { get; set; }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Each agent type, which shall be available for the scenario configuration have to be registered within the ",(0,s.jsx)(n.code,{children:"ModelDescription"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Use method ",(0,s.jsx)(n.code,{children:"AddAgent<TAgentType, TLayerType>()"})," expects therefore the connection of the agents to its responsible layer:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// Define the description when not already happened\n// var description = new ModelDescription();\n\n// Register the agent type before adding the agent type.\ndescription.AddLayer<MyLayerType>();\n\ndescription.AddAgent<MyAgentType, MyLayerType>();\n"})}),"\n",(0,s.jsxs)(n.p,{children:["When each agent type is registered, the type and their parameter can be used within the ",(0,s.jsx)(n.a,{href:"/docs/tutorial/configuration/agent_config",children:"scenario configuration"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Note that the respective layer type must be registered to the ",(0,s.jsx)(n.code,{children:"ModelDescription"})," beforehand."]})}),"\n",(0,s.jsx)(n.h2,{id:"passing-input-to-the-agent",children:"Passing input to the Agent"}),"\n",(0,s.jsxs)(n.p,{children:["To initialize agents or entities with given inputs the ",(0,s.jsx)(n.code,{children:"IAgentManager"})," or the ",(0,s.jsx)(n.code,{children:"IEntityManager"})," is used. Both components read the scenario configuration and use the mapping to create objects from it."]}),"\n",(0,s.jsxs)(n.p,{children:["For example, to use the ",(0,s.jsx)(n.code,{children:"IAgentManager"}),", a layer (more on defining layers ",(0,s.jsx)(n.a,{href:"/docs/tutorial/development/layers",children:"here"}),") can be used to load the component that provides the ",(0,s.jsx)(n.code,{children:"IAgentManager"})," interface, for example inside the ",(0,s.jsx)(n.code,{children:"InitLayer()"})," method:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public class MyAgentLayer : AbstractLayer \n{\n    public override bool InitLayer(TInitData layerInitData, RegisterAgent registerAgentHandle, UnregisterAgent unregisterAgentHandle)\n    {\n        base.InitLayer(layerInitData, registerAgentHandle, unregisterAgentHandle);\n        // Resolve the required model component.\n        var agentManager = layerInitData.Container.Resolve<IAgentManager>();\n        \n        // Create and register objects of type MyAgentType.\n        var agents = agentManager.Spawn<MyAgentType>();\n        \n        // Otherwise only create them but do not registering \n        // to trigger their Tick() method. \n        var nonRegisteredAgents = agentManager.Create<MyAgentType>().ToList();\n        \n        return true;\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"Spawn<MyAgentType>()"})," call creates and registers a set of agents from the configuration, unless otherwise specified in the call, and uses the mapping to assign properties of each ",(0,s.jsx)(n.code,{children:"MyAgentType"})," object with the desired value."]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["The number of agents is defined in the configuration via the ",(0,s.jsx)(n.code,{children:"count"})," switch."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"Spawn<MyAgentType>()"})," call returns an ",(0,s.jsx)(n.strong,{children:"iterator for creating and registering"})," objects. The ",(0,s.jsx)(n.a,{href:"https://docs.microsoft.com/de-de/dotnet/csharp/programming-guide/concepts/linq/",children:".NET Language Integrated Query (LINQ)"})," technology allows subsequent queries on the set of objects before they are actually created. Only when ",(0,s.jsx)(n.code,{children:"ToList()"})," is iterated or called do the statements actually pass through."]})}),"\n",(0,s.jsxs)(n.p,{children:["Using ",(0,s.jsx)(n.code,{children:"PropertyDescription"})," annotation for those parameters of an agent or entity which shall be assigned with input data from outside. Properties must be publicly visible and have both a ",(0,s.jsx)(n.code,{children:"get"})," (getter) and ",(0,s.jsx)(n.code,{children:"set"})," (setter) to allow values to be written."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public class MyAgentType : IAgent<MyLayer> \n{\n    [PropertyDescription]\n    public double InputProperty { get; set; }\n\n\n\n    public void Init(MyLayer layer) { }\n    \n    public void Tick() \n    {\n        // do something with the input\n\t    Console.WriteLine(InputProperty);\n    }\n    \n    public Guid ID { get; set; }\n} \n\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"PropertyDescription"})," is used to mark properties of a type to make this a scenario configuration (described ",(0,s.jsx)(n.a,{href:"/docs/tutorial/configuration/agent_config",children:"here"}),") externally visible."]}),"\n",(0,s.jsxs)(n.p,{children:["Inside the ",(0,s.jsx)(n.code,{children:"mappings"})," a value or indirection mapping can be done via the name of the model element (here ",(0,s.jsx)(n.code,{children:"InputProperty"}),")."]}),"\n",(0,s.jsx)(n.h3,{id:"direct-value-assignment",children:"Direct value assignment"}),"\n",(0,s.jsxs)(n.p,{children:["Values for properties can be assigned to instances of a type directly in the configuration. A direct assignment assigns the property via a name (here ",(0,s.jsx)(n.code,{children:"InputProperty"}),") with a desired value that conforms to the typing of the property (",(0,s.jsx)(n.code,{children:"double"}),"-precision value of ",(0,s.jsx)(n.code,{children:"InputProperty"}),")."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "name": "MyAgentType",\n  "mappings":[\n    {"name": "InputProperty", "value": 3.141 } \n  ]\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The system tries to convert the input to the type automatically, so other input such as value written as ",(0,s.jsx)(n.code,{children:'"3.14"'})," are also possible. However, if the input does not conform to the given type, an exception is raised. For example, the ",(0,s.jsx)(n.code,{children:"InputProperty"})," which is typed as ",(0,s.jsx)(n.code,{children:"double"})," is assigned the value ",(0,s.jsx)(n.code,{children:"true"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "name": "MyAgentType",\n  "mappings":[\n    {"name": "InputProperty", "value": true } \n  ]\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Then the system throws the following exception:"}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsxs)(n.p,{children:["The type ",(0,s.jsx)(n.code,{children:"Double"})," for property ",(0,s.jsx)(n.code,{children:"InputProperty"})," is not compatible with input ",(0,s.jsx)(n.code,{children:"True"}),"."]})}),"\n",(0,s.jsx)(n.h3,{id:"indirect-value-assignment",children:"Indirect value assignment"}),"\n",(0,s.jsxs)(n.p,{children:["An ",(0,s.jsx)(n.em,{children:"indirect value assignment"})," allows to initialize each instance of an agent with its individual data objects. These data objects are stored in a file (for instance a csv-file), which is assigned to the agent type in the simulation config.\nA given source (here ",(0,s.jsx)(n.code,{children:"myAgentType.csv"}),") contains ",(0,s.jsx)(n.em,{children:"x"})," data objects (rows, without header row). Each data row represents one agent instance:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"fieldNameInCsv"}),(0,s.jsx)(n.th,{children:"anotherField"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"0.481"}),(0,s.jsx)(n.td,{children:"gold"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"1.482"}),(0,s.jsx)(n.td,{children:"silver"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"79.13"}),(0,s.jsx)(n.td,{children:"copper"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"100.48"}),(0,s.jsx)(n.td,{children:"platinum"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["The attribute ",(0,s.jsx)(n.code,{children:"fieldNameInCsv"})," of the input ",(0,s.jsx)(n.code,{children:"myAgentType.csv"})," ",(0,s.jsx)(n.strong,{children:"does not"})," correspond to the name ",(0,s.jsx)(n.code,{children:"InputProperty"})," of the model object. To access the values of the field, the field name must be specified to ",(0,s.jsx)(n.em,{children:"redirect"})," the access reading the source:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "name": "MyAgentType",\n  "file": "myAgentType.csv",\n  "mappings":[\n    {"name": "InputProperty", "field": "fieldNameInCsv" }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"alternative-names",children:"Alternative names"}),"\n",(0,s.jsxs)(n.p,{children:["Instead of the property name from the model (here ",(0,s.jsx)(n.code,{children:"InputProperty"}),") a field ",(0,s.jsx)(n.code,{children:"Name"})," with an alternative attribute name can be specified at the ",(0,s.jsx)(n.code,{children:"PropertyDescription"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'public class MyAgentType : IAgent<MyLayer> \n{\n    [PropertyDescription(Name = "myOtherName"]\n    public double InputProperty { get; set; }\n} \n'})}),"\n",(0,s.jsxs)(n.p,{children:["Mapping of values can now be specified via ",(0,s.jsx)(n.code,{children:"MyInputProperty"})," and ",(0,s.jsx)(n.code,{children:"myOtherName"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "name": "MyAgentType",\n  "mappings":[\n    {"name": "myOtherName", "value": 3.141 }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"required-properties",children:"Required properties"}),"\n",(0,s.jsxs)(n.p,{children:["Models that define parameters that ",(0,s.jsx)(n.strong,{children:"must be externally mapped"})," can specify this requirement as ",(0,s.jsx)(n.code,{children:"Required"})," in ",(0,s.jsx)(n.code,{children:"PropertyDescription"}),". To initialize an object, there must then be a mapping for the respective annotated properties, otherwise the system throws an exception."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public class MyAgentType : IAgent<MyLayer> \n{\n    [PropertyDescription(Required = true)]\n    public double InputProperty { get; set; }\n} \n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},76195:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/agent_lifecycle-5d4dd76c7fd8b09122ff9d84d89aa284.png"},24808:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/mars_simulation_system-464703a4d0ffd85e3f53f724bd315b21.png"},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(96540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);